$(document).ready(function(){var e=$("#iconRule"),a=$("#ruleWindow"),t=$("#revokeBtn"),n=$("#letGo");e.click(function(){a.show()}),$("#returnGame").click(function(){a.hide()}),function(){if($("#revokeBtn,#letGo").attr("disabled",!0),BlackJackFuc.isAndroidIOS(),AppFunction.appInitGame(),BlackJackFuc.isAndroid){var e,a=document.documentElement.offsetHeight,t=$("#head").get(0).offsetHeight,n=$("#foot").get(0).offsetHeight;a<520?(e="13.56rem",$(".popWindow").css({height:e})):e=a-t-n+"px",$("#blackJack").css({height:e})}$("style").remove(),$("iframe").remove(),$("iframe").remove(),$("#_yn_g_g,#BAIDU_DUP_fp_wrapper").remove()}();var r=0,i=0,o=0,s=0,c=0;$("#chipList .chipNum").click(function(){t.removeAttr("disabled"),n.removeAttr("disabled");var e=$(this).index();i=o,o=e;var a=parseInt(GameMain.vpbeltchip[e]),m=commonVariable.url+"/chip60_"+(e+1)+".png";$("#betImg img").attr("src",m);var l=a>=1e4?a/1e4+"W":a;$("#betImg span").text(l),s+=a;var d=GameMain.userGoldBean-s;d>=0?($("#BeansNum").html(d),$("#betNum span").html(s),$("#bet").animate({fontSize:"0.9rem"},200,"ease",function(){$(this).animate({fontSize:"0.67rem"},300,"ease")}),i===o?r++:r=1,$("#bet").html(r)):$("#noEnough").show(),clearTimeout(c);var u=setTimeout(function(){r=0,$("#showBet").css({"-webkit-transform":"translateX(-4rem)","-moz-transform":"translateX(-4rem)","-ms-transform":"translateX(-4rem)","-o-transform":"translateX(-4rem)",transform:"translateX(-4rem)"})},3e3);c=u,$("#showBet").animate({"-webkit-transform":"translateX(0)","-moz-transform":"translateX(0)","-ms-transform":"translateX(0)","-o-transform":"translateX(0)",transform:"translateX(0)"},300,"ease")}),t.click(function(){r=0,$("#bet").html(r),$("#BeansNum").html(GameMain.userGoldBean),t.attr("disabled",!0),n.attr("disabled",!0),s=0,$("#betNum span").html(s),BlackJackFuc.hideShowBet()}),n.click(function(){t.attr("disabled",!0),n.attr("disabled",!0),BlackJackFuc.hideShowBet(),AppFunction.appBeginGame(s),$("#playerPoint,#bankerPoint").show()}),$("#getNext").click(function(){AppFunction.appGetPoker()}),$("#stopGet").click(function(){AppFunction.appStopGetPoker()}),$("#closeShare").click(function(){$("#shareWindow").hide(),setTimeout(function(){AppFunction.appToAnother()},1e3)}),$("#anotherGame").click(function(){$("#shareWindow").hide(),AppFunction.appToAnother()}),$("#shareBtn").click(function(){AppFunction.appToShare()}),$("#cancel").click(function(){$("#maxBeans").hide(),t.removeAttr("disabled")}),$("#makeSure").click(function(){$("#maxBeans").hide(),r=0,$("#BeansNum").html(GameMain.userGoldBean),t.attr("disabled",!0),n.attr("disabled",!0),s=0,$("#betNum span").html(s)}),$("#cancelRecharge").click(function(){$("#noEnough").hide(),r=0,BlackJackFuc.hideShowBet(),$("#BeansNum").html(GameMain.userGoldBean),t.attr("disabled",!0),n.attr("disabled",!0),s=0,$("#betNum span").html(s)}),$("#ToUpBeans").click(function(){$("#noEnough").hide(),r=0,BlackJackFuc.hideShowBet(),$("#BeansNum").html(GameMain.userGoldBean),t.attr("disabled",!0),n.attr("disabled",!0),s=0,$("#betNum span").html(s),AppFunction.appToAdd()}),$("#addBeans").click(function(){AppFunction.appToAdd()}),$("#exitGame").click(function(){$("#exitWindow").hide(),AppFunction.appExitGame()}),$("#goBackGame").click(function(){$("#exitWindow").hide()}),$("#iconRecord").click(function(){var e=window.location.href;window.location.href=e.substring(0,e.lastIndexOf("/"))+"/toblackJack_record.html"})});var strImgSrc=$("#clock img").attr("src"),androidPhone=!0;!function(){var e=navigator.userAgent,a=e.indexOf("Android")>-1||e.indexOf("Adr")>-1||e.indexOf("Linux")>-1,t=!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)||e.indexOf("iPad")>-1||e.indexOf("iPhone")>-1||e.indexOf("Mac OS")>-1;a&&(androidPhone=!0),t&&(androidPhone=!1)}();var urlStr;urlStr=androidPhone?"http:"+strImgSrc.substring(0,strImgSrc.lastIndexOf("/")):"https:"+strImgSrc.substring(0,strImgSrc.lastIndexOf("/"));var pokerUrl=urlStr+"/poker/",commonVariable={url:urlStr,poker:pokerUrl},anyNum=0,boomTimerIndex=0,isWinTimerIndex=0,BlackJackFuc={speed:.68,defaultDistance:1.5,defaultImgSrc:pokerUrl+"bg_poker.png",downTimer:null,pokerAreaTrance:.3,isAndroid:!1,changeBackImg:function(e){$("#blackJack").css({"background-image":"url("+e+")"})},hideShowBet:function(){$("#showBet").animate({"-webkit-transform":"translateX(-4rem)","-moz-transform":"translateX(-4rem)","-ms-transform":"translateX(-4rem)","-o-transform":"translateX(-4rem)",transform:"translateX(-4rem)"},1e3,"linear")},countDown:function(e,a){$("#minute").html(this.numShow(e)),$("#second").html(this.numShow(a));var t=this;this.downTimer=setInterval(function(){e>0?a>0?(a--,$("#second").html(t.numShow(a))):(a=60,e--,$("#minute").html(t.numShow(e)),$("#second").html(t.numShow(a))):a>0?(a--,$("#second").html(t.numShow(a))):AppFunction.appStopGetPoker()},1e3)},numShow:function(e){return e<10?e="0"+e:e},pokerAni:function(e,a,t,n,r,i,o,s,c,m,l,d){$("#TakeCardBtn button").attr("disabled",!0);var u=e.find("img"),p=e.parent(".pokerArea"),k=p.find(".poker").length,h=p.siblings(".pointText"),f=0;s?(GameMain.isHasHistory?f=k<=4?BlackJackFuc.pokerAreaTrance*(k-3):BlackJackFuc.pokerAreaTrance:k>2&&k<=4?f=BlackJackFuc.pokerAreaTrance*(k-2):k>4&&(f=.6),$("#playerPoker").animate({"-webkit-transform":"translateX("+-f+"rem)","-moz-transform":"translateX("+-f+"rem)","-ms-transform":"translateX("+-f+"rem)","-o-transform":"translateX("+-f+"rem)",transform:"translateX("+-f+"rem)"},1e3,"ease-in-out")):(k>2&&k<=4?f=BlackJackFuc.pokerAreaTrance*(k-2):k>4&&(f=.6),$("#bankerPoker").animate({"-webkit-transform":"translateX("+-f+"rem)","-moz-transform":"translateX("+-f+"rem)","-ms-transform":"translateX("+-f+"rem)","-o-transform":"translateX("+-f+"rem)",transform:"translateX("+-f+"rem)"},1e3,"ease-in-out")),e.animate({"-webkit-transform":"translate("+r+"rem,"+i+"rem)","-moz-transform":"translate("+r+"rem,"+i+"rem)","-ms-transform":"translate("+r+"rem,"+i+"rem)","-o-transform":"translate("+r+"rem,"+i+"rem)",transform:"translate("+r+"rem,"+i+"rem)"},{duration:t,easing:"ease-in-out",complete:function(){if(m||BlackJackFuc.rotateImg(u,a),h.html(o+"点"),s&&$("#TakeCardBtn button").removeAttr("disabled"),c){$("#playerPoint").removeClass("noBoom").addClass("boom"),clearTimeout(boomTimerIndex);var e=setTimeout(function(){BlackJackFuc.playerBoom(l)},700);$("#TakeCardBtn button").attr("disabled",!0),boomTimerIndex=e}if(void 0!==d){clearTimeout(isWinTimerIndex);var t=setTimeout(function(){BlackJackFuc.playerWin(d)},1400);isWinTimerIndex=t}},delay:n})},rotateImg:function(e,a){e.animate({"-webkit-transform":"rotateY(0)","-moz-transform":"rotateY(0)","-ms-transform":"rotateY(0)","-o-transform":"rotateY(0)",transform:"rotateY(0)"},300,"linear"),setTimeout(function(){e.attr("src",a)},100)},dealInit:function(e,a){for(var t,n,r=0,i=!1,o=0,s=0,c=0,m=!1,l=0;l<2;l++)$("#bankerPoker,#playerPoker").append("<div class='poker'><img src='' alt=''></div>"),$("#bankerPoker .poker").eq(l).find("img").attr("src",this.defaultImgSrc),$("#playerPoker .poker").eq(l).find("img").attr("src",this.defaultImgSrc),r=700*l,c=this.defaultDistance+this.speed*l,1===l?(t=this.defaultImgSrc,m=!0):(t=pokerUrl+a.mark+a.point+".png",s=a.sumPoint,m=!1),o=e[l].sumPoint,n=pokerUrl+e[l].mark+e[l].point+".png",this.pokerAni($("#playerPoker .poker").eq(l),n,700,r,c,0,o,!0,i),this.pokerAni($("#bankerPoker .poker").eq(l),t,700,r,c,0,s,!0,i,m)},playerGetPoker:function(e,a,t,n,r){var i=pokerUrl+e+a+".png",o=$("#playerPoker .poker").length;$("#playerPoker").append("<div class='poker'><img src='' alt=''></div>"),$("#playerPoker .poker").eq(o).find("img").attr("src",this.defaultImgSrc);var s=this.defaultDistance,c=0;o<=3?(s=this.speed*o+this.defaultDistance,c=0):o<=7?(s=this.speed*(o-4)+this.defaultDistance,c=.5):(s=this.speed*(o-8)+this.defaultDistance,c=1),this.pokerAni($("#playerPoker .poker").eq(o),i,700,0,s,c,t,!0,n,!1,r)},bankerGetPoker:function(e){var a=e.bankerPokerList,t=pokerUrl+a[1].mark+a[1].point+".png";this.rotateImg($("#bankerPoker .poker").eq(1).find("img"),t),$("#bankerPoint").html(a[1].sumPoint+"点");var n=$("#bankerPoker .poker").length;if(this.defaultDistance=1.5,a.length>2)for(var r,i=a.length-2,o=this.defaultDistance,s=0,c=0,m=0;m<i;m++){c=n+m,r=pokerUrl+a[c].mark+a[c].point+".png",$("#bankerPoker").append("<div class='poker'><img src='' alt=''></div>"),$("#bankerPoker .poker").eq(c).find("img").attr("src",this.defaultImgSrc);var l=700*m;m>=2&&m<6?(o=this.speed*(c-4)+this.defaultDistance,s=.5):m>=6&&m<10?(o=this.speed*(c-8)+this.defaultDistance,s=1):(o=this.speed*c+this.defaultDistance,s=0),this.pokerAni($("#bankerPoker .poker").eq(n+m),r,700,l,o,s,a[n+m].sumPoint,!1,!1,!1,[],e)}else setTimeout(function(){BlackJackFuc.playerWin(e)},700)},isAndroidIOS:function(){var e=navigator.userAgent,a=e.indexOf("Android")>-1||e.indexOf("Adr")>-1||e.indexOf("Linux")>-1,t=!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)||e.indexOf("iPad")>-1||e.indexOf("iPhone")>-1||e.indexOf("Mac OS")>-1;a&&(this.isAndroid=!0),t&&(this.isAndroid=!1)},createChips:function(e){for(var a,t=e.length,n=0;n<t;n++)a=e[n],a=a>=1e4?Math.floor(a/1e4)+"W":a,$("#chipList .chipNum").eq(n).find("span").html(a)},initCreatePoker:function(e,a){for(var t,n=0,r=0,i=a.length,o=0,s=this.defaultDistance-this.pokerAreaTrance*(i-2),c=0;c<i;c++){e.append("<div class='poker'><img src='' alt=''></div>");var m=e.find(".poker").eq(c);null===a[c]?(t=this.defaultImgSrc,o=180):(t=pokerUrl+a[c].mark+a[c].point+".png",o=0),c>=0&&c<4?(n=s+this.speed*c,r=0):c>=4&&c<7?(n=s+this.speed*(c-4),r=.5):(n=s+this.speed*(c-7),r=1),m.css({"-webkit-transform":"translate("+n+"rem,"+r+"rem)","-moz-transform":"translate("+n+"rem,"+r+"rem)","-ms-transform":"translate("+n+"rem,"+r+"rem)","-o-transform":"translate("+n+"rem,"+r+"rem)",transform:"translate("+n+"rem,"+r+"rem)"}),m.find("img").attr("src",t).css({"-webkit-transform":"rotateY("+o+"deg)","-moz-transform":"rotateY("+o+"deg)","-ms-transform":"rotateY("+o+"deg)","-o-transform":"rotateY("+o+"deg)",transform:"rotateY("+o+"deg)"})}this.defaultDistance=s},playerBlackJack:function(){setTimeout(function(){$("#blackJackWarn").show()},1600),clearInterval(BlackJackFuc.downTimer),$("#TakeCardBtn button").attr("disabled",!0)},playerBoom:function(e){$("#drawWarn").show().html("你输了"),clearInterval(BlackJackFuc.downTimer);var a=pokerUrl+e.mark+e.point+".png";BlackJackFuc.rotateImg($("#bankerPoker .poker").eq(1).find("img"),a),$("#bankerPoint").html(e.sumPoint+"点"),setTimeout(function(){AppFunction.appToAnother()},1e3)},playerWin:function(e){var a=e.isWin,t=e.BlackJack,n=e.goldBean;if(0==a)$("#drawWarn").show().html("平局"),setTimeout(function(){AppFunction.appToAnother()},1e3);else if(1==a){var r;$("#shareWindow").show(),r=t?urlStr+"/bg_blackJack.png":urlStr+"/bg_win.png",$("#shareImg img").attr("src",r),$("#shareText span").text(n)}else $("#drawWarn").show().html("你输了"),setTimeout(function(){AppFunction.appToAnother()},1e3)}},AppFunction={appInitGame:function(){BlackJackFuc.isAndroid?app.BJInitGameData(anyNum):window.webkit.messageHandlers.BJInitGameData.postMessage(anyNum),BlackJackFuc.isAndroid?app.BJGetCarousel(anyNum):window.webkit.messageHandlers.BJGetCarousel.postMessage(anyNum)},appBeginGame:function(e){BlackJackFuc.isAndroid?app.BJStartGame(e):window.webkit.messageHandlers.BJStartGame.postMessage(e)},appGetPoker:function(){BlackJackFuc.isAndroid?app.BJGetPoker(anyNum):window.webkit.messageHandlers.BJGetPoker.postMessage(anyNum)},appStopGetPoker:function(){BlackJackFuc.isAndroid?app.BJStopPokerGame(anyNum):window.webkit.messageHandlers.BJStopPokerGame.postMessage(anyNum)},appToLogin:function(){androidPhone?app.toLoginBackRefresh():window.webkit.messageHandlers.toLoginBackRefresh.postMessage(anyNum)},appToShare:function(){var e=urlStr+"/share-poker.jpg";BlackJackFuc.isAndroid?app.jumpSharePopupWindow(e):window.webkit.messageHandlers.jumpSharePopupWindow.postMessage(anyNum)},appToAdd:function(){BlackJackFuc.isAndroid?app.jumpRecharge(GameMain.userGoldBean):window.webkit.messageHandlers.jumpRecharge.postMessage(GameMain.userGoldBean)},appToAnother:function(){BlackJackFuc.isAndroid?app.OneMoreHand(anyNum):window.webkit.messageHandlers.OneMoreHand.postMessage(anyNum)},appExitGame:function(){BlackJackFuc.isAndroid?app.temporaryExit(anyNum):window.webkit.messageHandlers.temporaryExit.postMessage(anyNum)}},GameMain={userGoldBean:0,vpbeltchip:[],isHasHistory:!1,gameProcess:!1,initGame:function(e){var a=e.bgPhotoPath,t=commonVariable.url+a.substring(a.indexOf("bg")-1);BlackJackFuc.changeBackImg(t);var n=e.vpbeltchip;if(this.vpbeltchip=n,BlackJackFuc.createChips(n),e.success){var r=e.Nickname;$("#userId").html(r);var i;if(i=e.Userheadpath?commonVariable.url.substring(0,commonVariable.url.lastIndexOf("images"))+"/"+e.Userheadpath:commonVariable.url+"/default_userHead.png",$("#userHeadImg img").attr("src",i),this.userGoldBean=e.goldAllBean,$("#BeansNum").html(this.userGoldBean),null!==e.guessHistory){this.isHasHistory=!0,$("#gameInit").hide(),$("#TakeCard").show();var o=e.guessHistory.beltGoldbean;$("#betNum span").html(o);var s=e.minute,c=e.second;BlackJackFuc.countDown(s,c);var m=e.guessHistory.bankerPokerList,l=m[0].sumPoint+"点";$("#bankerPoint").text(l),BlackJackFuc.initCreatePoker($("#bankerPoker"),m);var d=e.guessHistory.playerPokerList,u=d[d.length-1].sumPoint+"点";$("#playerPoint").text(u),BlackJackFuc.initCreatePoker($("#playerPoker"),d)}else this.isHasHistory=!1,$("#gameInit").show(),$("#TakeCard").hide();this.gameProcess=!0}else $("#gameInit").show(),$("#TakeCard").hide(),null===e.userid&&($("#revokeBtn,#letGo").removeAttr("disabled"),$("#userId").html("未登录"),$("#BeansNum").html(0),$("#chipList .chipNum,#revokeBtn,#letGo").unbind("click"),$("#userInformation,#chipList,#revokeBtn,#letGo,#chipList .chipNum").click(function(){AppFunction.appToLogin()}),$("#addBeans").unbind("click")),this.gameProcess=!1},gameBegin:function(e){if(e.success){$("#gameInit").hide(),$("#TakeCard").show(),this.userGoldBean=e.goldAllBean,$("#BeansNum").html(this.userGoldBean);var a=e.minute,t=e.second;BlackJackFuc.countDown(a,t);var n=e.PlayerPoker,r=e.bankerPoker;BlackJackFuc.dealInit(n,r),e.BlackJack&&(BlackJackFuc.playerBlackJack(),setTimeout(function(){GameMain.inBankerRound(e)},2100))}else e.onMaxBeltBean?$("#maxBeans").show():$("#maxBeans").hide(),e.goldbeanNotEnough?$("#noEnough").show():$("#noEnough").hide()},getPoker:function(e){if(e.success){var a=e.nextPoker,t=a.mark,n=a.point,r=a.sumPoint,i=[];if(e.Boom){var o=e.bankerPokerList;i=o[o.length-1]}else i=[];BlackJackFuc.playerGetPoker(t,n,r,e.Boom,i),21===e.nextPoker.pointInt&&($("#TakeCardBtn button").attr("disabled",!0),setTimeout(function(){AppFunction.appStopGetPoker()},700))}},inBankerRound:function(e){this.isHasHistory=!1,$("#stopGet,#getNext").attr("disabled",!0),clearInterval(BlackJackFuc.downTimer),e.success&&BlackJackFuc.bankerGetPoker(e)},createSlideList:function(e){for(var a,t=e.carouselList,n=t.length,r=0;r<n;r++)$("#slidList").append("<li></li>"),$("#slidList li").eq(r).html(t[r]),a=24*t[r].length<=400?"400px":24*t[r].length+"px",$("#slidList li").eq(r).css({width:a});var i=this;setInterval(function(){i.slideTop()},5200)},slideTop:function(){var e,a=$("#slidList"),t=$("#slidList li").eq(0).get(0).offsetWidth,n=$("#playList").get(0).offsetWidth,r=$("#slidList li").eq(0).get(0).offsetHeight;e=t>n?BlackJackFuc.isAndroid?-200:-300:0,a.find("li").eq(0).animate({marginLeft:e},3e3,"ease",function(){a.animate({marginTop:-r},{duration:2e3,easing:"ease-in-out",complete:function(){a.css({marginTop:0}).find("li").eq(0).css({marginLeft:0}).appendTo(a)}})})},quitGame:function(){this.gameProcess?$("#exitWindow").show():AppFunction.appExitGame()}};